; Generated by JITX 2.25.0
#use-added-syntax(jitx)
defpackage main :
  import jitx
  import core
  import jitx/commands
  import ocdb/utils/generic-components
  import helpers
  import ocdb/modules/passive-circuits

; Define a default through-hole via for the PCB
pcb-via default-th:
  start = Top
  stop = Bottom
  diameter = 0.65
  hole-diameter = 0.4
  type = MechanicalDrill
  tented = true

; Define a via-in-pad for the PCB
pcb-via via-in-pad:
  start = Top
  stop = Bottom

  diameter = 0.3
  hole-diameter = 0.2
  type = MechanicalDrill
  via-in-pad = true

; Define the shape/size of the board
val board-shape = RoundedRectangle(60.0, 40.0, 0.25)

val my-stackup = ocdb/manufacturers/stackups/jlcpcb-jlc2313-6layer

pcb-board circuit-board :
  stackup = my-stackup
  vias = [default-th, via-in-pad]
  boundary = board-shape
  signal-boundary = offset(board-shape, -0.5)


; Module to run as a design
public pcb-module my-design :

  inst U1 : components/asm2464pd/component

  public net GND (U1.TEST_EN)

  for g in pins(U1.GND) do :
    net (GND g)


  ;public net GND (my-gnd, U1.TEST_EN)

  
  ; create USB connectors
  val usb-x-shift = 4.0
  val usb-y-shift = -7.0
  ; public inst in-usb : ocdb/components/xkb/U263-241N-4BQC11-1/component
  public inst in-usb : components/USB-C-1054500101/component
  place(in-usb) at loc((-1.0 * width(board-shape) / 2.0) + usb-x-shift, usb-y-shift, -90.0) on Top

  
  ; Write the board version on silkscreen
  inst version-label  : ocdb/artwork/board-text/version-silkscreen("Version 0.0")
  place(version-label) at loc(0.0, height(board-shape) / 2.0 - 1.0) on Bottom

; Set the design name     - a directory with this name will be generated under the "designs" directory
;     the board           - a Board object
;     [optional] rules    - the PCB design rules (if not givn default rules will be used)
;     [optional] vendors  - Strings or AuthorizedVendors (if not give default vendors will be used)
;     [optional] quantity - Minimum stock quantity the vendor should carry (if not give default quantity will be used)
setup-design(
  "jitx-design",
  circuit-board,
)

; Set the schematic sheet size
set-paper(ANSI-A)

set-use-layout-groups()

; Set the top level module (the module to be compile into a schematic and PCB)
set-main-module(my-design)

; Use any helper function from helpers.stanza here
run-check-on-design(my-design)

; View the results
view-board()
view-schematic()
view-design-explorer()